<!DOCTYPE html>
<html lang="zh">

  <head>
  <meta charset="utf-8">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Spring Boot 注解 @ConfigurationProperties · 技术分享</title>
  <meta name="author" content="Siran Yao(姚毅晨)" />

  
  <meta name="keywords" content="spring, Jdk源码, 基础">
  

  <meta name="generator" content="Hugo 0.65.2" />

  
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  
  <link href="/css/animate.css" rel="stylesheet">

  
  
  <link href="/css/style.default.css" rel="stylesheet" id="theme-stylesheet">
  

  
  <link href="/css/custom.css" rel="stylesheet">
  <link rel="stylesheet" href="/css/search.css" />

  
  
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
  <link rel="shortcut icon" href="/img/1587537069710-removebg-preview.png" type="image/x-icon" />
  <link rel="apple-touch-icon" href="/img/1587537069710-removebg-preview.png" />

  
  <link href="/css/owl.carousel.css" rel="stylesheet">
  <link href="/css/owl.theme.css" rel="stylesheet">
  <link rel="alternate" href="/index.xml" type="application/rss+xml" title="拳拳到肉">

  
  <link rel="stylesheet" href="/css/prism.css" />

  
  <meta property="og:title" content="Spring Boot 注解 @ConfigurationProperties" />
  <meta property="og:type" content="website" />
  <meta property="og:url" content="/blog/spring-boot-%E6%B3%A8%E8%A7%A3-configurationproperties//" />
  <meta property="og:image" content="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" />
  <meta property="og:image:alt" content="ServiceMesher Logo" />

  
  <meta name="description" content="简述 由于在分析Gateway的时候，Gateway通过 GatewayProperties 来自动配置外部配置，故写此文章。 先思考一个问题 Springboot 中我们加入Redis 配置文件，Spr">
  <meta property="og:description" content="简述 由于在分析Gateway的时候，Gateway通过 GatewayProperties 来自动配置外部配置，故写此文章。 先思考一个问题 Springboot 中我们加入Redis 配置文件，Spr">
  <meta name="twitter:description" content="简述 由于在分析Gateway的时候，Gateway通过 GatewayProperties 来自动配置外部配置，故写此文章。 先思考一个问题 Springboot 中我们加入Redis 配置文件，Spr">
  <meta property="og:description" content="简述 由于在分析Gateway的时候，Gateway通过 GatewayProperties 来自动配置外部配置，故写此文章。 先思考一个问题 Springboot 中我们加入Redis 配置文件，Spr" />

  
  <meta name="referrer" content="never">

  
  
  <script>
  var _hmt = _hmt || [];
  (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?154337f0d95f0b110f98c1d5d7038895";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
  </script>


  
  

</head>


  <body>



    <div id="all">

        <header>

          <div class="navbar-affixed-top" data-spy="affix" data-offset-top="200">

    <div class="navbar navbar-default yamm" role="navigation" id="navbar">

        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="hidden-xs hidden-sm">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="visible-xs visible-sm">
                    <span class="sr-only">Spring Boot 注解 @ConfigurationProperties - 跳到主页</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                      <span class="sr-only">切换导航</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="hidden-xs hidden-sm">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="visible-xs visible-sm">
                    <span class="sr-only">Spring Boot 注解 @ConfigurationProperties - 跳到主页</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                        <span class="sr-only">切换导航</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            <div class="navbar-header">
                <a class="navbar-brand home" href="/">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="hidden-xs hidden-sm">
                    <img src="/img/6a04b428gy1fzy78qjmomg206o06ojsg.gif" alt="Spring Boot 注解 @ConfigurationProperties logo" class="visible-xs visible-sm">
                    <span class="sr-only">Spring Boot 注解 @ConfigurationProperties - 跳到主页</span>
                </a>
                <div class="navbar-buttons">
                    <button type="button" class="navbar-toggle btn-template-main" data-toggle="collapse" data-target="#navigation">
                        <span class="sr-only">切换导航</span>
                        <i class="fa fa-align-justify"></i>
                    </button>
                </div>
            </div>
            

            <div class="navbar-collapse collapse" id="navigation">
                <ul class="nav navbar-nav navbar-right">
                  
                  <li class="dropdown">
                    
                    <a href="/">主页</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/blog/">博客</a>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">文档 <span class="caret"></span></a>
                    <ul class="dropdown-menu">
                      
                        <li><a href="https://www.elastic.co/">Elastic 官网</a></li>
                      
                        <li><a href="http://pulsar.apache.org/en/">Pulsar官网</a></li>
                      
                    </ul>
                    
                  </li>
                  
                  <li class="dropdown">
                    
                    <a href="/contact/">联系我</a>
                    
                  </li>
                  
                  
                    <li>
                        <a href="#modalSearch" data-toggle="modal" data-target="#modalSearch" style="outline: none;">
                        <span class="hidden-sm hidden-md hidden-lg">搜索</span> <span id="searchGlyph" class="glyphicon glyphicon-search"></span>
                    </a>
                    </li>
                  
                </ul>
            </div>
            

        </div>
    </div>
    

</div>




<div id="modalSearch" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">&times;</button>
        <h4 class="modal-title">博客搜索</h4>
      </div>
      <div class="modal-body">
          
<div class="aa-input-container" id="aa-input-container">
    <input type="search" id="aa-search-input" class="aa-input-search" placeholder="输入文章标题或摘要" name="search" autocomplete="off" autofocus="autofocus"/>
    <svg class="aa-input-icon" viewBox="654 -372 1664 1664">
        <path d="M1806,332c0-123.3-43.8-228.8-131.5-316.5C1586.8-72.2,1481.3-116,1358-116s-228.8,43.8-316.5,131.5  C953.8,103.2,910,208.7,910,332s43.8,228.8,131.5,316.5C1129.2,736.2,1234.7,780,1358,780s228.8-43.8,316.5-131.5  C1762.2,560.8,1806,455.3,1806,332z M2318,1164c0,34.7-12.7,64.7-38,90s-55.3,38-90,38c-36,0-66-12.7-90-38l-343-342  c-119.3,82.7-252.3,124-399,124c-95.3,0-186.5-18.5-273.5-55.5s-162-87-225-150s-113-138-150-225S654,427.3,654,332  s18.5-186.5,55.5-273.5s87-162,150-225s138-113,225-150S1262.7-372,1358-372s186.5,18.5,273.5,55.5s162,87,225,150s113,138,150,225  S2062,236.7,2062,332c0,146.7-41.3,279.7-124,399l343,343C2305.7,1098.7,2318,1128.7,2318,1164z" />
    </svg>
</div>
<script src="/js/algoliasearch.min.js"></script>
<script src="/js/autocomplete.min.js"></script>

<script>
var client = algoliasearch("X4YB3WOBNV", "d2134c5a8d250e6d3246594240c45201");
var index = client.initIndex("servicemesher");

autocomplete('#aa-search-input',
{ hint: false}, {
    source: autocomplete.sources.hits(index, {hitsPerPage: 5}),
    
    displayKey: 'name',
    
    templates: {
        
        suggestion: function(suggestion) {
            baseURL=""
            baseURL=baseURL.substring(0,baseURL.length-1)
            return '<span>' + '<a href="' + baseURL + suggestion.url+ '">' +
                suggestion._highlightResult.title.value + '</a></span>'+
                '<span>'+suggestion._highlightResult.summary.value+'</span>';
        }
    }
});
</script>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
      </div>
    </div>
  </div>
</div>


        </header>

        <div id="heading-breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>Spring Boot 注解 @ConfigurationProperties</h1>
            </div>
        </div>
    </div>
</div>


        <div id="content">
            <div class="container">

                <div class="row">

                    

                    <div class="col-md-9" id="blog-post">
                        <div class="well">
                            <div class="author-category">
                            <i class="fa fa-calendar-o">
                            2020年4月17日
                            </i>
                            |
                            
                            作者 Siran
                            
                            
                            
                            |
                            3100字 | 阅读大约需要7分钟
                            </div>
                            
                            
                            <div class="author-category">
                            
                            
                            归档于 <a href="/categories/spring">spring</a>
                            
                            |
                            
                            
                            
                            标签
                            
                            <a style="text-transform:capitalize" href="/tags/spring-boot/"><i>#spring boot</i></a>
                            
                            </div>
                            
                            
                        </div>
                        <div id="post-content">
                          <h3 id="简述">简述</h3>
<p>由于在分析Gateway的时候，Gateway通过 GatewayProperties 来自动配置外部配置，故写此文章。</p>
<p>先思考一个问题 Springboot 中我们加入Redis 配置文件，Springboot 是如何加载配置的呢？</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">spring.redis.url=<span style="color:#ae81ff">127.0.0.1</span>:<span style="color:#ae81ff">6379</span>
spring.redis.host=localhost
spring.redis.password=<span style="color:#ae81ff">123</span>
</code></pre></div><p>其中都是以 <code>spring.redis</code> 为前缀。这其实是 <code>Spring Boot</code> 为每个组件提供了对应的 <code>Properties</code> 配置类，并将配置文件中的属性值給映射到配置类中，而且它们有个特点，都是以 <code>Properties</code> 结尾，如 <code>Redis</code> 对应的配置类是 <code>RedisProperties</code>：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span>prefix <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;spring.redis&#34;</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisProperties</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> String url<span style="color:#f92672">;</span>

	<span style="color:#66d9ef">private</span> String host <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;localhost&#34;</span><span style="color:#f92672">;</span>

	<span style="color:#66d9ef">private</span> String password<span style="color:#f92672">;</span>

	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">int</span> port <span style="color:#f92672">=</span> 6379<span style="color:#f92672">;</span>
	
<span style="color:#f92672">}</span>
</code></pre></div><p>其中有个名为 <code>@ConfigurationProperties</code> 的注解，它的 <code>prefix</code> 参数就是<code>spring.redis</code>。该注解的功能就是将配置文件中的属性和 <code>Properties</code> 配置类中的属性进行映射，来达到自动配置的目的。这个过程分为两步，第一步是注册 <code>Properties</code> 配置类，第二步是绑定配置属性，过程中还涉及到一个注解，它就是 <code>@EnableConfigurationProperties</code> ，该注解是用来触发那两步操作的。我们以 <code>Redis</code> 为例来看它使用方式：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#f92672">...</span>
<span style="color:#a6e22e">@EnableConfigurationProperties</span><span style="color:#f92672">(</span>RedisProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">RedisAutoConfiguration</span> <span style="color:#f92672">{</span>
    <span style="color:#f92672">...</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>可以看到它的参数是 <code>RedisProperties</code> 配置类。这个注解就是关键，我们就来从此分析。</p>
<hr>
<h3 id="源码分析">源码分析</h3>
<h4 id="enableconfigurationproperties">@EnableConfigurationProperties</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@Target</span><span style="color:#f92672">(</span>ElementType<span style="color:#f92672">.</span><span style="color:#a6e22e">TYPE</span><span style="color:#f92672">)</span>
<span style="color:#a6e22e">@Retention</span><span style="color:#f92672">(</span>RetentionPolicy<span style="color:#f92672">.</span><span style="color:#a6e22e">RUNTIME</span><span style="color:#f92672">)</span>
<span style="color:#a6e22e">@Documented</span>
<span style="color:#a6e22e">@Import</span><span style="color:#f92672">(</span>EnableConfigurationPropertiesImportSelector<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">)</span>
<span style="color:#66d9ef">public</span> <span style="color:#a6e22e">@interface</span> EnableConfigurationProperties <span style="color:#f92672">{</span>

	<span style="color:#75715e">/**
</span><span style="color:#75715e">	 * Convenient way to quickly register {@link ConfigurationProperties} annotated beans
</span><span style="color:#75715e">	 * with Spring. Standard Spring Beans will also be scanned regardless of this value.
</span><span style="color:#75715e">	 * @return {@link ConfigurationProperties} annotated beans to register
</span><span style="color:#75715e">	 */</span>
	Class<span style="color:#f92672">&lt;?&gt;[]</span> value<span style="color:#f92672">()</span> <span style="color:#66d9ef">default</span> <span style="color:#f92672">{};</span>

<span style="color:#f92672">}</span>

</code></pre></div><hr>
<h4 id="enableconfigurationpropertiesimportselector">EnableConfigurationPropertiesImportSelector</h4>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EnableConfigurationPropertiesImportSelector</span> <span style="color:#66d9ef">implements</span> ImportSelector <span style="color:#f92672">{</span>

	<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String<span style="color:#f92672">[]</span> IMPORTS <span style="color:#f92672">=</span> <span style="color:#f92672">{</span> 
    <span style="color:#75715e">//① 用于注册 Properties类
</span><span style="color:#75715e"></span>    ConfigurationPropertiesBeanRegistrar<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(),</span>
    <span style="color:#75715e">//②用于进行绑定配置属性
</span><span style="color:#75715e"></span>			ConfigurationPropertiesBindingPostProcessorRegistrar<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">()</span> <span style="color:#f92672">};</span>

	<span style="color:#a6e22e">@Override</span>
	<span style="color:#66d9ef">public</span> String<span style="color:#f92672">[]</span> <span style="color:#a6e22e">selectImports</span><span style="color:#f92672">(</span>AnnotationMetadata metadata<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
		<span style="color:#66d9ef">return</span> IMPORTS<span style="color:#f92672">;</span>
	<span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p><code>①</code> 用于注册 Properties类</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">//org.springframework.boot.context.properties.EnableConfigurationPropertiesImportSelector的内部类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConfigurationPropertiesBeanRegistrar</span> <span style="color:#66d9ef">implements</span> ImportBeanDefinitionRegistrar <span style="color:#f92672">{</span>
  
      <span style="color:#a6e22e">@Override</span>
      <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">registerBeanDefinitions</span><span style="color:#f92672">(</span>AnnotationMetadata metadata<span style="color:#f92672">,</span> BeanDefinitionRegistry registry<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//① 调用 getTypes 方法，返回 Properties 配置类集合。
</span><span style="color:#75715e"></span>      <span style="color:#75715e">//② 调用 register 方法，把 Properties 配置类注册到 Spring 容器中。
</span><span style="color:#75715e"></span>          getTypes<span style="color:#f92672">(</span>metadata<span style="color:#f92672">).</span><span style="color:#a6e22e">forEach</span><span style="color:#f92672">((</span>type<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> register<span style="color:#f92672">(</span>registry<span style="color:#f92672">,</span> <span style="color:#f92672">(</span>ConfigurableListableBeanFactory<span style="color:#f92672">)</span> registry<span style="color:#f92672">,</span> type<span style="color:#f92672">));</span>
      <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p><code>①  getTypes</code>，返回Properties 配置类集合</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>Class<span style="color:#f92672">&lt;?&gt;&gt;</span> getTypes<span style="color:#f92672">(</span>AnnotationMetadata metadata<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//获取指定注解的所有属性值，key是属性名称，Value是值
</span><span style="color:#75715e"></span>            MultiValueMap<span style="color:#f92672">&lt;</span>String<span style="color:#f92672">,</span> Object<span style="color:#f92672">&gt;</span> attributes <span style="color:#f92672">=</span> metadata
<span style="color:#f92672">.</span><span style="color:#a6e22e">getAllAnnotationAttributes</span><span style="color:#f92672">(</span>EnableConfigurationProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">(),</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">);</span>
      
      <span style="color:#75715e">// 返回 key 名称为 value 的值，这里返回的就是 Properties 配置类
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> collectClasses<span style="color:#f92672">((</span>attributes <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">?</span> attributes<span style="color:#f92672">.</span><span style="color:#a6e22e">get</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;value&#34;</span><span style="color:#f92672">)</span> <span style="color:#f92672">:</span> Collections<span style="color:#f92672">.</span><span style="color:#a6e22e">emptyList</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
    
<span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>Class<span style="color:#f92672">&lt;?&gt;&gt;</span> collectClasses<span style="color:#f92672">(</span>List<span style="color:#f92672">&lt;?&gt;</span> values<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">return</span> values<span style="color:#f92672">.</span><span style="color:#a6e22e">stream</span><span style="color:#f92672">().</span><span style="color:#a6e22e">flatMap</span><span style="color:#f92672">((</span>value<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> Arrays<span style="color:#f92672">.</span><span style="color:#a6e22e">stream</span><span style="color:#f92672">((</span>Object<span style="color:#f92672">[])</span> value<span style="color:#f92672">)).</span><span style="color:#a6e22e">map</span><span style="color:#f92672">((</span>o<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#f92672">(</span>Class<span style="color:#f92672">&lt;?&gt;)</span> o<span style="color:#f92672">)</span>
                    <span style="color:#f92672">.</span><span style="color:#a6e22e">filter</span><span style="color:#f92672">((</span>type<span style="color:#f92672">)</span> <span style="color:#f92672">-&gt;</span> <span style="color:#66d9ef">void</span><span style="color:#f92672">.</span><span style="color:#a6e22e">class</span> <span style="color:#f92672">!=</span> type<span style="color:#f92672">).</span><span style="color:#a6e22e">collect</span><span style="color:#f92672">(</span>Collectors<span style="color:#f92672">.</span><span style="color:#a6e22e">toList</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
</code></pre></div></li>
<li>
<p><code>②  调用 register 方法</code>，把 Properties 配置类注册到 Spring 容器中。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">register</span><span style="color:#f92672">(</span>BeanDefinitionRegistry registry<span style="color:#f92672">,</span> ConfigurableListableBeanFactory beanFactory<span style="color:#f92672">,</span>Class<span style="color:#f92672">&lt;?&gt;</span> type<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">// getName 返回的是 Bean 的名称
</span><span style="color:#75715e"></span>            String name <span style="color:#f92672">=</span> getName<span style="color:#f92672">(</span>type<span style="color:#f92672">);</span>
      <span style="color:#75715e">// 判断有没有注册过这个 Bean
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>containsBeanDefinition<span style="color:#f92672">(</span>beanFactory<span style="color:#f92672">,</span> name<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
        <span style="color:#75715e">//不存在则，则进行注册
</span><span style="color:#75715e"></span>                registerBeanDefinition<span style="color:#f92672">(</span>registry<span style="color:#f92672">,</span> name<span style="color:#f92672">,</span> type<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
        <span style="color:#f92672">}</span>
    
    
<span style="color:#66d9ef">private</span> String <span style="color:#a6e22e">getName</span><span style="color:#f92672">(</span>Class<span style="color:#f92672">&lt;?&gt;</span> type<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">// 获取 Properties 配置类上标注的 ConfigurationProperties 注解信息
</span><span style="color:#75715e"></span>            ConfigurationProperties annotation <span style="color:#f92672">=</span> AnnotationUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">findAnnotation</span><span style="color:#f92672">(</span>type<span style="color:#f92672">,</span> ConfigurationProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
      <span style="color:#75715e">//获取该注解中 prefix 的属性值
</span><span style="color:#75715e"></span>            String prefix <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>annotation <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">?</span> annotation<span style="color:#f92672">.</span><span style="color:#a6e22e">prefix</span><span style="color:#f92672">()</span> <span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;&#34;</span><span style="color:#f92672">;</span>
      <span style="color:#75715e">//拼装名字  属性前缀-配置类全路径名
</span><span style="color:#75715e"></span>      <span style="color:#75715e">//如: spring.redis-org.springframework.boot.autoconfigure.data.redis.RedisProperties
</span><span style="color:#75715e"></span>            <span style="color:#66d9ef">return</span> <span style="color:#f92672">(</span>StringUtils<span style="color:#f92672">.</span><span style="color:#a6e22e">hasText</span><span style="color:#f92672">(</span>prefix<span style="color:#f92672">)</span> <span style="color:#f92672">?</span> prefix <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;-&#34;</span> <span style="color:#f92672">+</span> type<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">()</span> <span style="color:#f92672">:</span> type<span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">());</span>
        <span style="color:#f92672">}</span>
    
<span style="color:#75715e">//下面这两个方法就是Spring注入，不是本文分析的重点。
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> <span style="color:#66d9ef">boolean</span> <span style="color:#a6e22e">containsBeanDefinition</span><span style="color:#f92672">(</span>ConfigurableListableBeanFactory beanFactory<span style="color:#f92672">,</span> String name<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>beanFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">containsBeanDefinition</span><span style="color:#f92672">(</span>name<span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">true</span><span style="color:#f92672">;</span>
            <span style="color:#f92672">}</span>
            BeanFactory parent <span style="color:#f92672">=</span> beanFactory<span style="color:#f92672">.</span><span style="color:#a6e22e">getParentBeanFactory</span><span style="color:#f92672">();</span>
            <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>parent <span style="color:#66d9ef">instanceof</span> ConfigurableListableBeanFactory<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
                <span style="color:#66d9ef">return</span> c
    				
    				
                <span style="color:#a6e22e">ontainsBeanDefinition</span><span style="color:#f92672">((</span>ConfigurableListableBeanFactory<span style="color:#f92672">)</span> parent<span style="color:#f92672">,</span> name<span style="color:#f92672">);</span>
            <span style="color:#f92672">}</span>
            <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">false</span><span style="color:#f92672">;</span>
        <span style="color:#f92672">}</span>
    
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">registerBeanDefinition</span><span style="color:#f92672">(</span>BeanDefinitionRegistry registry<span style="color:#f92672">,</span> String name<span style="color:#f92672">,</span> Class<span style="color:#f92672">&lt;?&gt;</span> type<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
            assertHasAnnotation<span style="color:#f92672">(</span>type<span style="color:#f92672">);</span>
            GenericBeanDefinition definition <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> GenericBeanDefinition<span style="color:#f92672">();</span>
            definition<span style="color:#f92672">.</span><span style="color:#a6e22e">setBeanClass</span><span style="color:#f92672">(</span>type<span style="color:#f92672">);</span>
            registry<span style="color:#f92672">.</span><span style="color:#a6e22e">registerBeanDefinition</span><span style="color:#f92672">(</span>name<span style="color:#f92672">,</span> definition<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
</code></pre></div><p>到这里所有需要的 Properties配置类 就被注册到了 <code>Spring</code> 容器中。接下来就是与配制类进行绑定。</p>
</li>
</ul>
</li>
<li>
<p><code>②</code> 用于进行绑定配置属性</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConfigurationPropertiesBindingPostProcessorRegistrar</span> <span style="color:#66d9ef">implements</span> ImportBeanDefinitionRegistrar <span style="color:#f92672">{</span>
  
<span style="color:#a6e22e">@Override</span>
  <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">registerBeanDefinitions</span><span style="color:#f92672">(</span>AnnotationMetadata importingClassMetadata<span style="color:#f92672">,</span> BeanDefinitionRegistry registry<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(!</span>registry<span style="color:#f92672">.</span><span style="color:#a6e22e">containsBeanDefinition</span><span style="color:#f92672">(</span>ConfigurationPropertiesBindingPostProcessor<span style="color:#f92672">.</span><span style="color:#a6e22e">BEAN_NAME</span><span style="color:#f92672">))</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//① 真正用来绑定属性的
</span><span style="color:#75715e"></span>          registerConfigurationPropertiesBindingPostProcessor<span style="color:#f92672">(</span>registry<span style="color:#f92672">);</span>
      <span style="color:#75715e">//② 存储元数据
</span><span style="color:#75715e"></span>          registerConfigurationBeanFactoryMetadata<span style="color:#f92672">(</span>registry<span style="color:#f92672">);</span>
      <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p><code>① 绑定属性</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">registerConfigurationPropertiesBindingPostProcessor</span><span style="color:#f92672">(</span>BeanDefinitionRegistry registry<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        GenericBeanDefinition definition <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> GenericBeanDefinition<span style="color:#f92672">();</span>
        definition<span style="color:#f92672">.</span><span style="color:#a6e22e">setBeanClass</span><span style="color:#f92672">(</span>ConfigurationPropertiesBindingPostProcessor<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
        definition<span style="color:#f92672">.</span><span style="color:#a6e22e">setRole</span><span style="color:#f92672">(</span>BeanDefinition<span style="color:#f92672">.</span><span style="color:#a6e22e">ROLE_INFRASTRUCTURE</span><span style="color:#f92672">);</span>
        registry<span style="color:#f92672">.</span><span style="color:#a6e22e">registerBeanDefinition</span><span style="color:#f92672">(</span>ConfigurationPropertiesBindingPostProcessor<span style="color:#f92672">.</span><span style="color:#a6e22e">BEAN_NAME</span><span style="color:#f92672">,</span> definition<span style="color:#f92672">);</span>
    
    <span style="color:#f92672">}</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConfigurationPropertiesBindingPostProcessor</span>
        <span style="color:#66d9ef">implements</span> BeanPostProcessor<span style="color:#f92672">,</span> PriorityOrdered<span style="color:#f92672">,</span> ApplicationContextAware<span style="color:#f92672">,</span> InitializingBean <span style="color:#f92672">{</span>
    
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * The bean name that this post-processor is registered with.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String BEAN_NAME <span style="color:#f92672">=</span> ConfigurationPropertiesBindingPostProcessor<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getName</span><span style="color:#f92672">();</span>
    
    <span style="color:#75715e">/**
</span><span style="color:#75715e">     * The bean name of the configuration properties validator.
</span><span style="color:#75715e">     */</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">final</span> String VALIDATOR_BEAN_NAME <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;configurationPropertiesValidator&#34;</span><span style="color:#f92672">;</span>
    
    <span style="color:#66d9ef">private</span> ConfigurationBeanFactoryMetadata beanFactoryMetadata<span style="color:#f92672">;</span>
    
    <span style="color:#66d9ef">private</span> ApplicationContext applicationContext<span style="color:#f92672">;</span>
    
    <span style="color:#66d9ef">private</span> ConfigurationPropertiesBinder configurationPropertiesBinder<span style="color:#f92672">;</span>
    
  <span style="color:#75715e">// ① 重写的 ApplicationContextAware 接口中的方法，用来获取 ApplicationContext 上下文对象
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">setApplicationContext</span><span style="color:#f92672">(</span>ApplicationContext applicationContext<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> BeansException <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">applicationContext</span> <span style="color:#f92672">=</span> applicationContext<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
      
  <span style="color:#75715e">// ②  重写的 InitializingBean 接口中的方法，当 Bean 的属性初始化后会被调用。
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">afterPropertiesSet</span><span style="color:#f92672">()</span> <span style="color:#66d9ef">throws</span> Exception <span style="color:#f92672">{</span>
    <span style="color:#75715e">//初始化beanFactoryMetadata
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">beanFactoryMetadata</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">applicationContext</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getBean</span><span style="color:#f92672">(</span>ConfigurationBeanFactoryMetadata<span style="color:#f92672">.</span><span style="color:#a6e22e">BEAN_NAME</span><span style="color:#f92672">,</span>
                ConfigurationBeanFactoryMetadata<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
    <span style="color:#75715e">//初始化configurationPropertiesBinder
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">configurationPropertiesBinder</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ConfigurationPropertiesBinder<span style="color:#f92672">(</span><span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">applicationContext</span><span style="color:#f92672">,</span>
                VALIDATOR_BEAN_NAME<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
    
  <span style="color:#75715e">//排序
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">int</span> <span style="color:#a6e22e">getOrder</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> Ordered<span style="color:#f92672">.</span><span style="color:#a6e22e">HIGHEST_PRECEDENCE</span> <span style="color:#f92672">+</span> 1<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
    
  <span style="color:#75715e">//③ 重写的 BeanPostProcessor 接口中的方法，在 Bean 初始化前会被调用，绑定属性的操作就是从这里开始。 
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">@Override</span>
    <span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">postProcessBeforeInitialization</span><span style="color:#f92672">(</span>Object bean<span style="color:#f92672">,</span> String beanName<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> BeansException <span style="color:#f92672">{</span>
        ConfigurationProperties annotation <span style="color:#f92672">=</span> getAnnotation<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">,</span> ConfigurationProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>annotation <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//绑定开始
</span><span style="color:#75715e"></span>            bind<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">,</span> annotation<span style="color:#f92672">);</span>
        <span style="color:#f92672">}</span>
        <span style="color:#66d9ef">return</span> bean<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>    
<span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p>实现的几个接口：</p>
<ul>
<li>
<p><code>BeanPostProcessor</code>：这是 <code>Bean</code> 的后置处理器。该类有两个方法，一个是 postProcessBeforeInitialization ，<code>Bean</code> 初始化前该方法会被调用；
另一个是 postProcessAfterInitialization ，<code>Bean</code> 初始化后该方法会被调用；需注意的是，<code>Spring</code> 上下文中所有 <code>Bean</code> 的初始化都会触发这两个方法。</p>
</li>
<li>
<p><code>ApplicationContextAware</code>：这是 <code>Spring</code>的 <code>Aware</code>系列接口之一。该类有一个 setApplicationContext 方法，主要是用来获取 <code>ApplicationContext</code> 上下文对象；同理，如果是其它前缀的 <code>Aware</code>，则获取相应前缀名的对象。</p>
</li>
<li>
<p><code>InitializingBean</code>：这是 <code>Bean</code> 的生命周期相关接口。该类有一个 afterPropertiesSet 方法，当 <code>Bean</code> 的所有属性初始化后，该方法会被调用。</p>
<p>其中， <code>BeanPostProcessor</code> 和 <code>InitializingBean</code> 的功能都是在 <code>Bean</code> 的生命周期中执行额外的操作。</p>
</li>
</ul>
</li>
<li>
<p><code>① setApplicationContext</code> : 重写的 ApplicationContextAware 接口中的方法，用来获取 ApplicationContext 上下文对象</p>
</li>
<li>
<p><code>② afterPropertiesSet</code> : 重写的 InitializingBean 接口中的方法，当 Bean 的属性初始化后会被调用。该方法主要是会初始化<code>configurationPropertiesBinder</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ConfigurationPropertiesBinder</span> <span style="color:#f92672">{</span>
      
  ConfigurationPropertiesBinder<span style="color:#f92672">(</span>ApplicationContext applicationContext<span style="color:#f92672">,</span> String validatorBeanName<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//① 上下文
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">applicationContext</span> <span style="color:#f92672">=</span> applicationContext<span style="color:#f92672">;</span>
    <span style="color:#75715e">//② 获取外部的所有配置
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">propertySources</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> PropertySourcesDeducer<span style="color:#f92672">(</span>applicationContext<span style="color:#f92672">).</span><span style="color:#a6e22e">getPropertySources</span><span style="color:#f92672">();</span>
    <span style="color:#75715e">//③ 配置的校验器
</span><span style="color:#75715e"></span>      <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">configurationPropertiesValidator</span> <span style="color:#f92672">=</span> getConfigurationPropertiesValidator<span style="color:#f92672">(</span>applicationContext<span style="color:#f92672">,</span>
              validatorBeanName<span style="color:#f92672">);</span>
      <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">jsr303Present</span> <span style="color:#f92672">=</span> ConfigurationPropertiesJsr303Validator<span style="color:#f92672">.</span><span style="color:#a6e22e">isJsr303Present</span><span style="color:#f92672">(</span>applicationContext<span style="color:#f92672">);</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p><strong>主要看②，获取外部的所有配置。</strong></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#75715e">// ①通过 extractEnvironmentPropertySources 方法，返回 MutablePropertySources 对象，MutablePropertySources 是 PropertySources 的实现类
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> PropertySources <span style="color:#a6e22e">getPropertySources</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
      PropertySourcesPlaceholderConfigurer configurer <span style="color:#f92672">=</span> getSinglePropertySourcesPlaceholderConfigurer<span style="color:#f92672">();</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>configurer <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">return</span> configurer<span style="color:#f92672">.</span><span style="color:#a6e22e">getAppliedPropertySources</span><span style="color:#f92672">();</span>
      <span style="color:#f92672">}</span>
    <span style="color:#75715e">//② 调用 Environment 的 getPropertySources 方法，返回 MutablePropertySources
</span><span style="color:#75715e"></span>      MutablePropertySources sources <span style="color:#f92672">=</span> extractEnvironmentPropertySources<span style="color:#f92672">();</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>sources <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">return</span> sources<span style="color:#f92672">;</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> IllegalStateException<span style="color:#f92672">(</span>
              <span style="color:#e6db74">&#34;Unable to obtain PropertySources from &#34;</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;PropertySourcesPlaceholderConfigurer or Environment&#34;</span><span style="color:#f92672">);</span>
  <span style="color:#f92672">}</span>
      
<span style="color:#75715e">//这里的Environment 就是在SpringBoot 初始化的时候创建的  Environment
</span><span style="color:#75715e"></span><span style="color:#66d9ef">private</span> MutablePropertySources <span style="color:#a6e22e">extractEnvironmentPropertySources</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
      Environment environment <span style="color:#f92672">=</span> <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">applicationContext</span><span style="color:#f92672">.</span><span style="color:#a6e22e">getEnvironment</span><span style="color:#f92672">();</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>environment <span style="color:#66d9ef">instanceof</span> ConfigurableEnvironment<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">return</span> <span style="color:#f92672">((</span>ConfigurableEnvironment<span style="color:#f92672">)</span> environment<span style="color:#f92672">).</span><span style="color:#a6e22e">getPropertySources</span><span style="color:#f92672">();</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
</code></pre></div><p>到这里就是已经获取到所有外部的配置了。具体的配置文件是如何被加载成Environment的，</p>
<p>可以看我的这篇文章。</p>
<p><a href="http://www.sirann.cn/blog/spring-boot-additionallocation%E5%8F%82%E6%95%B0/">Spring Boot additional—location 参数</a></p>
</li>
<li>
<p><code>③ postProcessBeforeInitialization</code> : 重写的 BeanPostProcessor 接口中的方法，在 Bean 初始化前会被调用，绑定属性的操作就是从这里开始</p>
<p>通过上面 ② 中的 afterPropertiesSet 方法，初始化好了 ConfigurationPropertiesBinder 对象以及获取到了 Environment 对象，那么这里就开始与配置类进行绑定了</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> Object <span style="color:#a6e22e">postProcessBeforeInitialization</span><span style="color:#f92672">(</span>Object bean<span style="color:#f92672">,</span> String beanName<span style="color:#f92672">)</span> <span style="color:#66d9ef">throws</span> BeansException <span style="color:#f92672">{</span>
    <span style="color:#75715e">//① 判断当前类是否被@ConfigurationProperties 注解
</span><span style="color:#75715e"></span>      ConfigurationProperties annotation <span style="color:#f92672">=</span> getAnnotation<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">,</span> ConfigurationProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
      <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>annotation <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//② 进行绑定
</span><span style="color:#75715e"></span>          bind<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">,</span> annotation<span style="color:#f92672">);</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">return</span> bean<span style="color:#f92672">;</span>
  <span style="color:#f92672">}</span>
      
      
<span style="color:#66d9ef">private</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>Object bean<span style="color:#f92672">,</span> String beanName<span style="color:#f92672">,</span> ConfigurationProperties annotation<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      ResolvableType type <span style="color:#f92672">=</span> getBeanType<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">);</span>
      Validated validated <span style="color:#f92672">=</span> getAnnotation<span style="color:#f92672">(</span>bean<span style="color:#f92672">,</span> beanName<span style="color:#f92672">,</span> Validated<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
      Annotation<span style="color:#f92672">[]</span> annotations <span style="color:#f92672">=</span> <span style="color:#f92672">(</span>validated <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span> <span style="color:#f92672">?</span> <span style="color:#66d9ef">new</span> Annotation<span style="color:#f92672">[]</span> <span style="color:#f92672">{</span> annotation<span style="color:#f92672">,</span> validated <span style="color:#f92672">}</span>
              <span style="color:#f92672">:</span> <span style="color:#66d9ef">new</span> Annotation<span style="color:#f92672">[]</span> <span style="color:#f92672">{</span> annotation <span style="color:#f92672">};</span>
      Bindable<span style="color:#f92672">&lt;?&gt;</span> target <span style="color:#f92672">=</span> Bindable<span style="color:#f92672">.</span><span style="color:#a6e22e">of</span><span style="color:#f92672">(</span>type<span style="color:#f92672">).</span><span style="color:#a6e22e">withExistingValue</span><span style="color:#f92672">(</span>bean<span style="color:#f92672">).</span><span style="color:#a6e22e">withAnnotations</span><span style="color:#f92672">(</span>annotations<span style="color:#f92672">);</span>
      <span style="color:#66d9ef">try</span> <span style="color:#f92672">{</span>
      <span style="color:#75715e">//③ 会发现这个是调用了在afterPropertiesSet方法初始化好的configurationPropertiesBinder中的bind方法。
</span><span style="color:#75715e"></span>          <span style="color:#66d9ef">this</span><span style="color:#f92672">.</span><span style="color:#a6e22e">configurationPropertiesBinder</span><span style="color:#f92672">.</span><span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>target<span style="color:#f92672">);</span>
      <span style="color:#f92672">}</span>
      <span style="color:#66d9ef">catch</span> <span style="color:#f92672">(</span>Exception ex<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
          <span style="color:#66d9ef">throw</span> <span style="color:#66d9ef">new</span> ConfigurationPropertiesBindException<span style="color:#f92672">(</span>beanName<span style="color:#f92672">,</span> bean<span style="color:#f92672">,</span> annotation<span style="color:#f92672">,</span> ex<span style="color:#f92672">);</span>
      <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
</code></pre></div><ul>
<li>
<p>③ 会发现这个是调用了在afterPropertiesSet方法初始化好的configurationPropertiesBinder中的bind方法。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>Bindable<span style="color:#f92672">&lt;?&gt;</span> target<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
    <span style="color:#75715e">//校验是否是@ConfigurationProperties 注解的
</span><span style="color:#75715e"></span>        ConfigurationProperties annotation <span style="color:#f92672">=</span> target<span style="color:#f92672">.</span><span style="color:#a6e22e">getAnnotation</span><span style="color:#f92672">(</span>ConfigurationProperties<span style="color:#f92672">.</span><span style="color:#a6e22e">class</span><span style="color:#f92672">);</span>
        Assert<span style="color:#f92672">.</span><span style="color:#a6e22e">state</span><span style="color:#f92672">(</span>annotation <span style="color:#f92672">!=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">,</span> <span style="color:#f92672">()</span> <span style="color:#f92672">-&gt;</span> <span style="color:#e6db74">&#34;Missing @ConfigurationProperties on &#34;</span> <span style="color:#f92672">+</span> target<span style="color:#f92672">);</span>
        List<span style="color:#f92672">&lt;</span>Validator<span style="color:#f92672">&gt;</span> validators <span style="color:#f92672">=</span> getValidators<span style="color:#f92672">(</span>target<span style="color:#f92672">);</span>
        BindHandler bindHandler <span style="color:#f92672">=</span> getBindHandler<span style="color:#f92672">(</span>annotation<span style="color:#f92672">,</span> validators<span style="color:#f92672">);</span>
    <span style="color:#75715e">//绑定
</span><span style="color:#75715e"></span>        getBinder<span style="color:#f92672">().</span><span style="color:#a6e22e">bind</span><span style="color:#f92672">(</span>annotation<span style="color:#f92672">.</span><span style="color:#a6e22e">prefix</span><span style="color:#f92672">(),</span> target<span style="color:#f92672">,</span> bindHandler<span style="color:#f92672">);</span>
    <span style="color:#f92672">}</span>
</code></pre></div><p>到这里就已经知道了 <code>@ConfigurationProperties</code>  它是怎么运作的，我个人就分析到这。如果要分析如何绑定的，那么请自行分析</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<h3 id="总结">总结：</h3>
<ul>
<li>
<p>其实当我们使用 <code>@ConfigurationProperties</code> 时，无需标注 <code>@EnableConfigurationProperties</code> 注解，因为 <code>Spring Boot</code> 在自动装配的过程中会帮我们加载一个名为 <code>ConfigurationPropertiesAutoConfiguration</code> 的类，该类是在 <code>spring.factories</code> 中定义好的：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#960050;background-color:#1e0010">#</span> Auto Configure
org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">.</span><span style="color:#a6e22e">autoconfigure</span><span style="color:#f92672">.</span><span style="color:#a6e22e">EnableAutoConfiguration</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">\</span>
org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">.</span><span style="color:#a6e22e">autoconfigure</span><span style="color:#f92672">.</span><span style="color:#a6e22e">context</span><span style="color:#f92672">.</span><span style="color:#a6e22e">ConfigurationPropertiesAutoConfiguration</span>
</code></pre></div></li>
<li>
<p>外部的所有配置文件都会被填充到 <code>Environment</code> 对象中，<code>@ConfigurationProperties</code> 其实也就会获取绑定器然后获取 <code>Environment</code> 对象，根据被注解的类与之进行映射达到自动配置的目的。</p>
</li>
<li>
<p>这篇文章主要是为了我在分析Gateway 而写的</p>
<ul>
<li>
<p>Gateway 通过 GatewayProperties 来自动装配我们在 properties 或者 yml 中的配置，所以为什么我们在进行配置的时候需要加上<code>spring.cloud.gateway</code></p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#a6e22e">@ConfigurationProperties</span><span style="color:#f92672">(</span><span style="color:#e6db74">&#34;spring.cloud.gateway&#34;</span><span style="color:#f92672">)</span> <span style="color:#75715e">//① 表明以 &#34;spring.cloud.gateway&#34; 前缀的 properties 会绑定 GatewayProperties。
</span><span style="color:#75715e"></span><span style="color:#a6e22e">@Validated</span>
<span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GatewayProperties</span> <span style="color:#f92672">{</span>
  <span style="color:#75715e">//Route
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>RouteDefinition<span style="color:#f92672">&gt;</span> routes <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
  <span style="color:#75715e">//filter
</span><span style="color:#75715e"></span>  <span style="color:#66d9ef">private</span> List<span style="color:#f92672">&lt;</span>FilterDefinition<span style="color:#f92672">&gt;</span> defaultFilters <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> ArrayList<span style="color:#f92672">&lt;&gt;();</span>
<span style="color:#f92672">}</span>  
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yml" data-lang="yml">//看到这里是不是已经豁然开朗了
<span style="color:#66d9ef">spring</span>:
  <span style="color:#66d9ef">cloud</span>:
    <span style="color:#66d9ef">gateway</span>:
      <span style="color:#66d9ef">routes</span>:
      - <span style="color:#66d9ef">id</span>: websocket_test
        <span style="color:#66d9ef">uri</span>: ws://localhost:<span style="color:#ae81ff">9000</span>
        <span style="color:#66d9ef">order</span>: <span style="color:#ae81ff">9000</span>
        <span style="color:#66d9ef">predicates</span>:
        - Path=/echo
</code></pre></div></li>
<li>
<p>但是Gateway 的自动装配没有加入<code>ConfigurationPropertiesAutoConfiguration</code>，它是通过 <code>GatewayAutoConfiguration</code> 来开启 <code>@ConfigurationProperties</code> 的</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#960050;background-color:#1e0010">#</span> Auto Configure
org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">boot</span><span style="color:#f92672">.</span><span style="color:#a6e22e">autoconfigure</span><span style="color:#f92672">.</span><span style="color:#a6e22e">EnableAutoConfiguration</span><span style="color:#f92672">=</span><span style="color:#960050;background-color:#1e0010">\</span>
org<span style="color:#f92672">.</span><span style="color:#a6e22e">springframework</span><span style="color:#f92672">.</span><span style="color:#a6e22e">cloud</span><span style="color:#f92672">.</span><span style="color:#a6e22e">gateway</span><span style="color:#f92672">.</span><span style="color:#a6e22e">config</span><span style="color:#f92672">.</span><span style="color:#a6e22e">GatewayAutoConfiguration</span><span style="color:#f92672">,</span><span style="color:#960050;background-color:#1e0010">\</span>
          
        
<span style="color:#a6e22e">@EnableConfigurationProperties</span><span style="color:#75715e">// 开启 @ConfigurationProperties
</span><span style="color:#75715e"></span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">GatewayAutoConfiguration</span> <span style="color:#f92672">{</span>
<span style="color:#f92672">}</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>

                        </div>
                        
                        
                        
                        
                        <ul class="pager blog-pager">
                        
                        <li class="previous">
                        <a href="/blog/resilience4j-circuitbreaker-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" data-toggle="tooltip" data-placement="top" title="Resilience4j CircuitBreaker 源码分析">&larr; 上一篇</a>
                        </li>
                         
                        <li class="next">
                        <a href="/blog/gateway%E4%B8%80%E5%88%9D%E5%A7%8B%E5%8C%96/" data-toggle="tooltip" data-placement="top" title="Gateway（一）初始化">下一篇 &rarr;</a>
                        </li>
                        
                        </ul>
                        
                        
                        


                    </div>
                    

                    

                    

                    <div class="col-md-3">

                        

                        <div class="panel panel-default sidebar-menu">
     
    <div class="panel-heading">
     <h3 class="panel-title">相关文章</h3>
    </div>
    <div class="panel-body">
     <ul class="nav nav-pills nav-stacked">
        
        <li><a href="/blog/spring-boot-additionallocation%E5%8F%82%E6%95%B0/"><i class="fa fa-link"></i>Spring Boot additional—location 参数</a></li>
         
        <li><a href="/blog/longadder-%E8%AF%A6%E8%A7%A3/"><i class="fa fa-link"></i>LongAdder 详解</a></li>
         
        <li><a href="/blog/condition-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><i class="fa fa-link"></i>Condition 源码分析</a></li>
         
        <li><a href="/blog/priorityqueue-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><i class="fa fa-link"></i>PriorityQueue 源码分析</a></li>
         
        <li><a href="/blog/countdownlatch-%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/"><i class="fa fa-link"></i>CountDownLatch 源码分析</a></li>
         
     </ul>
    </div>
     
</div>





<div class="panel panel-default sidebar-menu">

    <div class="panel-heading">
      <h3 class="panel-title">分类</h3>
    </div>

    <div class="panel-body">
        <ul class="nav nav-pills nav-stacked">
            
            <li><a href="/categories/gateway"><i class="fa fa-navicon"></i>gateway (4)</a>
            </li>
            
            <li><a href="/categories/guava"><i class="fa fa-navicon"></i>guava (1)</a>
            </li>
            
            <li><a href="/categories/java"><i class="fa fa-navicon"></i>java (7)</a>
            </li>
            
            <li><a href="/categories/jvm"><i class="fa fa-navicon"></i>jvm (2)</a>
            </li>
            
            <li><a href="/categories/resilience4j"><i class="fa fa-navicon"></i>resilience4j (1)</a>
            </li>
            
            <li><a href="/categories/skywalking"><i class="fa fa-navicon"></i>skywalking (2)</a>
            </li>
            
            <li><a href="/categories/spring"><i class="fa fa-navicon"></i>spring (2)</a>
            </li>
            
            <li><a href="/categories/%e5%88%86%e5%b8%83%e5%bc%8f"><i class="fa fa-navicon"></i>分布式 (3)</a>
            </li>
            
            <li><a href="/categories/%e5%b9%b6%e5%8f%91%e7%bc%96%e7%a8%8b"><i class="fa fa-navicon"></i>并发编程 (17)</a>
            </li>
            
            <li><a href="/categories/%e6%b6%88%e6%81%af%e9%98%9f%e5%88%97"><i class="fa fa-navicon"></i>消息队列 (22)</a>
            </li>
            
            <li><a href="/categories/%e7%ae%97%e6%b3%95"><i class="fa fa-navicon"></i>算法 (3)</a>
            </li>
            
            <li><a href="/categories/%e8%ae%a1%e7%ae%97%e6%9c%ba"><i class="fa fa-navicon"></i>计算机 (8)</a>
            </li>
            
        </ul>
    </div>
</div>







                        

                    </div>
                    

                    

                </div>
                

            </div>
            
        </div>
        

        <footer id="footer">
    <div class="container">

        
        <div class="col-md-4 col-sm-6">
            <h4>关于我</h4>

            <p>想当程序员的程序员</p>

            <hr class="hidden-md hidden-lg hidden-sm">

            <h4>友情连接</h4>

            <p>&nbsp;<a href="https://www.theyann.xyz:8123/home.html"> theyann</a></p>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

        <div class="col-md-4 col-sm-6">

             
            <h4>最新博客</h4>

            <div class="blog-entries">
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/kafka-controller-%E6%A8%A1%E5%9D%97%E4%B8%80%E6%A6%82%E8%BF%B0/">
                            
                            <img src="/img/blog/kafka/kafkaLogo.jpg" class="img-responsive" alt="Kafka Controller 模块（一）概述">
                            
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/kafka-controller-%E6%A8%A1%E5%9D%97%E4%B8%80%E6%A6%82%E8%BF%B0/">Kafka Controller 模块（一）概述</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/kafka-%E5%89%AF%E6%9C%AC%E6%A8%A1%E5%9D%97-replicamanager/">
                            
                            <img src="/img/blog/kafka/kafkaLogo.jpg" class="img-responsive" alt="Kafka 副本模块 ReplicaManager">
                            
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/kafka-%E5%89%AF%E6%9C%AC%E6%A8%A1%E5%9D%97-replicamanager/">Kafka 副本模块 ReplicaManager</a></h5>
                    </div>
                </div>
                
                <div class="item same-height-row clearfix">
                    <div class="image same-height-always">
                        <a href="/blog/kafka-%E6%97%B6%E9%97%B4%E8%BD%AE-java-%E7%89%88%E6%9C%AC%E5%AE%9E%E7%8E%B0/">
                            
                            <img src="/img/blog/banners/0069RVTdgy1fu1i0mvc5yj31ji15ob2b.jpg" class="img-responsive" alt="Kafka 时间轮 Java 版本实现">
                            
                        </a>
                    </div>
                    <div class="name same-height-always">
                        <h5><a href="/blog/kafka-%E6%97%B6%E9%97%B4%E8%BD%AE-java-%E7%89%88%E6%9C%AC%E5%AE%9E%E7%8E%B0/">Kafka 时间轮 Java 版本实现</a></h5>
                    </div>
                </div>
                
            </div>

            <hr class="hidden-md hidden-lg">
             

        </div>
        

        
        <div class="col-md-4 col-sm-6 ">

            <h4>联系</h4>

            <p>个人微信</br>请备注姓名-公司信息</p><p><img src="/img/1.png"></p>
      

            <a href="/contact" class="btn btn-small btn-template-main">跳到联系页面</a>

            <hr class="hidden-md hidden-lg hidden-sm">

        </div>
        
        

    </div>
    
</footer>







<div id="copyright">
    <div class="container">
        <div class="col-md-12">
            
            <p class="pull-left">Copyright ©️ 2020, siran all rights reserved.</p>
            
            
            <p class="pull-left">&nbsp;<a href="http://www.beian.miit.gov.cn/"> 苏ICP备20005919号</a></p>
            
            <p class="pull-right">
                模板来自 <a href="https://bootstrapious.com/p/universal-business-e-commerce-template">Bootstrapious</a>.
                

                移植到 Hugo 来自 <a href="https://github.com/devcows/hugo-universal-theme">DevCows</a>.
            </p>
        </div>
    </div>
</div>





    </div>
    

    <script src="//code.jquery.com/jquery-3.1.1.min.js" integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js"></script>
<script src="/js/front.js"></script>


<script src="/js/owl.carousel.min.js"></script>

<script src="/js/prism.js"></script>


<script src="/js/algoliasearch.min.js"></script>
<script src="/js/autocomplete.min.js"></script>


  </body>
</html>
